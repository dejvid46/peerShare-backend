import{r as c}from"./index.d496d5ee.js";import v from"./x.7d28ca4b.js";import{c as j,a as N,A as S}from"./AvatarIcon.ec88cd77.js";import{t as W,m as B,c as k,o as H,d as T,e as J,v as _,f as K,j as e,g as u,u as U}from"./UseWebSocket.b87fe84a.js";import{u as X}from"./UseWSCollector.cbd6d15a.js";import{r as q,n as G}from"./Parsers.472ab83d.js";import Q from"./enter.523c3648.js";import Y from"./warning.6e0b2c47.js";import{a as x,S as Z}from"./File.017130be.js";import ee from"./download.6ab6a9ba.js";import{a as se}from"./import.91a26c61.js";import{$ as ae}from"./real-module.31eaff73.js";import{a as le}from"./import.96d99fe6.js";import"./index.cca61219.js";var M=W({slots:{base:"flex flex-col gap-2 w-full",label:"",labelWrapper:"flex justify-between",value:"",track:"z-0 relative bg-default-300/50 overflow-hidden",indicator:"h-full"},variants:{color:{default:{indicator:"bg-default-400"},primary:{indicator:"bg-primary"},secondary:{indicator:"bg-secondary"},success:{indicator:"bg-success"},warning:{indicator:"bg-warning"},danger:{indicator:"bg-danger"}},size:{sm:{label:"text-small",value:"text-small",track:"h-1"},md:{label:"text-medium",value:"text-medium",track:"h-3"},lg:{label:"text-large",value:"text-large",track:"h-5"}},radius:{none:{track:"rounded-none",indicator:"rounded-none"},sm:{track:"rounded-small",indicator:"rounded-small"},md:{track:"rounded-medium",indicator:"rounded-medium"},lg:{track:"rounded-large",indicator:"rounded-large"},full:{track:"rounded-full",indicator:"rounded-full"}},isStriped:{true:{indicator:"bg-stripe-gradient bg-[length:1.25rem_1.25rem]"}},isIndeterminate:{true:{indicator:["absolute","w-full","origin-left","animate-indeterminate-bar"]}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:{},false:{indicator:"transition-transform !duration-500"}}},defaultVariants:{color:"primary",size:"md",radius:"full",isStriped:!1,isIndeterminate:!1,isDisabled:!1,disableAnimation:!1},compoundVariants:[{disableAnimation:!0,isIndeterminate:!1,class:{indicator:"!transition-none motion-reduce:transition-none"}}]},{twMerge:!1});function re(s,a=100){return Math.min(Math.max(s,0),a)}function te(s={}){const{rerender:a=!1,delay:r=0}=s,t=c.useRef(!1),[i,n]=c.useState(!1);return c.useEffect(()=>{t.current=!0;let l=null;return a&&(r>0?l=setTimeout(()=>{n(!0)},r):n(!0)),()=>{t.current=!1,a&&n(!1),l&&clearTimeout(l)}},[a]),[c.useCallback(()=>t.current,[]),i]}function ie(s){let{value:a=0,minValue:r=0,maxValue:t=100,valueLabel:i,isIndeterminate:n,formatOptions:l={style:"percent"}}=s,o=B(s,{labelable:!0}),{labelProps:f,fieldProps:g}=se({...s,labelElementType:"span"});a=le(a,r,t);let d=(a-r)/(t-r),m=ae(l);if(!n&&!i){let p=l.style==="percent"?d:a;i=m.format(p)}return{progressBarProps:k(o,{...g,"aria-valuenow":n?void 0:a,"aria-valuemin":r,"aria-valuemax":t,"aria-valuetext":n?void 0:i,role:"progressbar"}),labelProps:f}}function ne(s){const[a,r]=H(s,M.variantKeys),{ref:t,as:i,id:n,className:l,classNames:o,label:f,valueLabel:g,value:d=0,minValue:m=0,maxValue:p=100,showValueLabel:V=!1,formatOptions:O={style:"percent"},...$}=a,D=i||"div",w=T(t),C=J(o?.base,l),[,E]=te({rerender:!0,delay:100}),b=s.isIndeterminate,{progressBarProps:P,labelProps:I}=ie({id:n,label:f,value:d,minValue:m,maxValue:p,valueLabel:g,formatOptions:O,isIndeterminate:b,"aria-labelledby":s["aria-labelledby"],"aria-label":s["aria-label"]}),h=c.useMemo(()=>M({...r}),[...Object.values(r)]),F=s.disableAnimation?!0:E,L=c.useMemo(()=>b||!F?void 0:re((d-m)/(p-m)*100),[F,b,d,m,p]),A=c.useCallback((y={})=>({ref:w,"data-indeterminate":_(b),"data-disabled":_(s.isDisabled),className:h.base({class:C}),...k(P,$,y)}),[w,h,b,s.isDisabled,C,P,$]),R=c.useCallback((y={})=>({className:h.label({class:o?.label}),...k(I,y)}),[h,o,I]);return{Component:D,domRef:w,slots:h,classNames:o,label:f,percentage:L,showValueLabel:V,getProgressBarProps:A,getLabelProps:R}}var z=K((s,a)=>{const{Component:r,slots:t,classNames:i,label:n,percentage:l,showValueLabel:o,getProgressBarProps:f,getLabelProps:g}=ne({...s,ref:a}),d=f(),m=n||o;return e.jsxs(r,{...d,children:[m?e.jsxs("div",{className:t.labelWrapper({class:i?.labelWrapper}),children:[n&&e.jsx("span",{...g(),children:n}),o&&e.jsx("span",{className:t.value({class:i?.value}),children:d["aria-valuetext"]})]}):null,e.jsx("div",{className:t.track({class:i?.track}),children:e.jsx("div",{className:t.indicator({class:i?.indicator}),style:{transform:`translateX(-${100-(l||0)}%)`}})})]})});z.displayName="NextUI.Progress";var oe=z;function ce({item:s,remove:a,sendMess:r}){return e.jsx(j,{shadow:"none",className:"h-full",children:e.jsx(N,{className:"flex flex-col p-3 bg-default-100",children:e.jsxs("div",{className:"grow w-full flex",children:[e.jsxs("div",{className:"grow flex sm:flex-col items-center sm:items-start sm:gap-2 justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8",children:e.jsx(S,{id:s.id,p:!0})}),e.jsx("div",{children:"wants to join"})]}),e.jsx("div",{className:"flex gap-2 sm:px-0 px-2",children:e.jsx(u,{size:"sm",color:"success",variant:"bordered",onClick:()=>{r(`/send ${s.room} ${s.id}`),a(s)},children:"Invite"})})]}),e.jsx("div",{className:"flex flex-col justify-center sm:justify-start",children:e.jsx(u,{isIconOnly:!0,className:"data-[hover]:bg-foreground/10",radius:"full",variant:"light",size:"sm",onClick:()=>{a(s)},children:e.jsx("div",{className:"w-4 h-4",children:e.jsx("img",{className:"fill-default-300/50",src:v,alt:"Hide icon"})})})})]})})})}function de({item:s,remove:a,sendMess:r}){return e.jsx(j,{shadow:"none",className:"h-full",children:e.jsx(N,{className:"flex flex-col p-3 bg-default-100",children:e.jsxs("div",{className:"grow w-full flex",children:[e.jsxs("div",{className:"grow flex sm:flex-col items-center sm:items-start sm:gap-2 justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8",children:e.jsx("img",{className:"h-auto w-full",src:Q,alt:"enter room icon"})}),e.jsxs("div",{children:["join room ",s.room,"?"]})]}),e.jsx("div",{className:"flex gap-2 sm:px-0 px-2",children:e.jsx(u,{size:"sm",color:"success",variant:"bordered",onClick:()=>{r(`/join ${s.room} ${s.key}`),r("/room"),r("/members"),a(s)},children:"Join"})})]}),e.jsx("div",{className:"flex flex-col justify-center sm:justify-start",children:e.jsx(u,{isIconOnly:!0,className:"data-[hover]:bg-foreground/10",radius:"full",variant:"light",size:"sm",onClick:()=>{a(s)},children:e.jsx("div",{className:"w-4 h-4",children:e.jsx("img",{className:"fill-default-300/50",src:v,alt:"Hide icon"})})})})]})})})}function me({item:s,remove:a}){return e.jsx(j,{shadow:"none",className:"h-full",children:e.jsx(N,{className:"flex flex-col p-3 bg-default-100 sm:gap-3",children:e.jsxs("div",{className:"grow w-full flex",children:[e.jsx("div",{className:"grow flex sm:flex-col items-center sm:items-start sm:gap-3 justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8",children:e.jsx("img",{className:"h-auto w-full ",src:Y,alt:"enter room icon"})}),e.jsx("div",{children:s.error_message})]})}),e.jsx("div",{className:"flex flex-col justify-center sm:justify-start",children:e.jsx(u,{isIconOnly:!0,className:"data-[hover]:bg-foreground/10",radius:"full",variant:"light",size:"sm",onClick:()=>{a(s)},children:e.jsx("div",{className:"w-4 h-4",children:e.jsx("img",{className:"fill-default-300/50",src:v,alt:"Hide icon"})})})})]})})})}function ue(s){const[a,r]=c.useState(x.instance.getFile(s)),[t,i]=c.useState(0);return c.useEffect(()=>{const n=x.instance.getFile(s);n&&(i(Math.floor(n.position/n.maxChunks*100)),r(n)),x.instance.onFileChange(s,l=>{i(Math.floor(l.position/l.maxChunks*100)),r(l)})},[s]),{file:a,progress:t}}function fe({file:s,progress:a,saveFile:r,cancelFile:t}){return e.jsx("div",{className:"grow w-full flex",children:e.jsxs("div",{className:"grow flex flex-col items-start sm:gap-1 justify-between",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6",children:e.jsx("img",{src:ee,alt:"Hide icon"})}),e.jsx("p",{className:"text-sm",children:"from:"}),e.jsx("div",{className:"w-7 h-7",children:e.jsx(S,{id:s.id_from,p:!0})})]}),e.jsx(u,{isIconOnly:!0,className:"data-[hover]:bg-foreground/10",radius:"full",variant:"light",size:"sm",onClick:t,children:e.jsx("div",{className:"w-4 h-4",children:e.jsx("img",{className:"fill-default-300/50",src:v,alt:"Hide icon"})})})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-ellipsis overflow-hidden inline-block max-w-6 font-bold",children:s.name}),s.state!=="uploaded"&&e.jsx(oe,{size:"sm","aria-label":"Downloading...",value:a,className:"max-w-md py-2"})]}),s.state==="uploaded"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full gap-3",children:[e.jsx(u,{size:"sm",color:"success",variant:"bordered",onClick:r,children:"Download"}),e.jsx(u,{size:"sm",color:"danger",variant:"bordered",onClick:t,children:"Cancel"})]})})]})})}function xe({item:s,remove:a}){const{file:r,progress:t}=ue(s.uuid);if(!r)return e.jsx(e.Fragment,{});const i=()=>{x.instance.deleteFile(s.uuid),a(s)},n=()=>{const l=x.instance.getFile(s.uuid);l?.state==="uploaded"&&Z(s.uuid,l.blob,l.name),a(s)};return e.jsx(j,{shadow:"none",className:"h-full max-w-20",children:e.jsx(N,{className:"flex flex-col p-3 bg-default-100",children:e.jsx(fe,{file:r,progress:t,saveFile:n,cancelFile:i})})})}function Fe(){const{lastMess:s,sendMess:a}=U(q),{collector:r,remove:t,dropColector:i,setCollector:n}=X(G);return c.useEffect(()=>{x.instance.onNewFile(l=>{n(o=>[...o,{uuid:l}])})},[]),c.useEffect(()=>{i()},[s]),s?e.jsx("div",{dir:"rtl",className:"lg:fixed bg-transparent lg:left-[5%] lg:max-w-[400px] lg:-translate-x-[5%] lg:-translate-y-2/4 lg:top-2/4 lg:max-h-[50%]",children:e.jsxs("div",{dir:"ltr",className:"lg:grid lg:gap-[0px_1rem] lg:grid-cols-[1fr] xl:grid-cols-[1fr_1fr] lg:grid-flow-dense",children:[e.jsx("div",{className:"invisible"}),e.jsx("div",{className:"invisible lg:row-[span_2]"}),r.map((l,o)=>{if(l.id)return e.jsx("div",{className:"mb-4 lg:row-[span_2] bg-transparent",children:e.jsx(ce,{sendMess:a,item:l,remove:t})},o);if(l.key)return e.jsx("div",{className:"mb-4 lg:row-[span_2] bg-transparent",children:e.jsx(de,{sendMess:a,item:l,remove:t})},o);if(l.error_message)return e.jsx("div",{className:"mb-4 lg:row-[span_2] bg-transparent",children:e.jsx(me,{item:l,remove:t})},o);if(l.uuid)return e.jsx("div",{className:"mb-4 lg:row-[span_2] bg-transparent",children:e.jsx(xe,{item:l,remove:t})},o)})]})}):e.jsx(e.Fragment,{})}export{Fe as default};
